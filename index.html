<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>ìë™ì°¨ ìœ ì§€ë¹„ ê³„ì‚°ê¸° | ì°¨ëŸ‰ ìœ ì§€ë¹„ AI ì •ë°€ ë¶„ì„ - Car Agent</title>
    
    <meta name="description" content="ìë™ì°¨ ìœ ì§€ë¹„ ê³„ì‚°ê¸° - ì°¨ëŸ‰ ëª¨ë¸, ì—°ì‹ë§Œ ì…ë ¥í•˜ë©´ AIê°€ ë³´í—˜ë£Œ, ì„¸ê¸ˆ, ìœ ë¥˜ë¹„, ì •ë¹„ë¹„ë¥¼ ì •ë°€ ë¶„ì„! ë‚´ ì°¨ ì›” ìœ ì§€ë¹„ë¥¼ ì§€ê¸ˆ ë¬´ë£Œë¡œ í™•ì¸í•˜ì„¸ìš”.">
    
    <style>
        body { font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background: #f5f5f7; color: #1d1d1f; line-height: 1.5; }
        .card { background: white; padding: 20px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 20px; }
        h1 { text-align: center; color: #1d1d1f; margin-bottom: 30px; font-size: 26px; font-weight: 800; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #86868b; font-size: 14px; font-weight: 600; }
        input, select { width: 100%; padding: 12px; border: 1px solid #d2d2d7; border-radius: 8px; box-sizing: border-box; font-size: 16px; background-color: #fff; appearance: none; }
        input:focus, select:focus { outline: none; border-color: #0071e3; box-shadow: 0 0 0 4px rgba(0,113,227,0.1); }
        
        button { width: 100%; padding: 16px; background: #0071e3; color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 17px; margin-top: 10px; transition: background 0.2s; }
        button:hover { background: #0077ed; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        .price-tag { font-size: 32px; font-weight: 800; color: #1d1d1f; text-align: center; margin: 10px 0; }
        .detail-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f0f0f0; }
        .detail-row:last-child { border-bottom: none; }
        
        /* ë°°ì§€ ìŠ¤íƒ€ì¼ ì •ì˜ */
        .badge { display: inline-block; padding: 2px 6px; border-radius: 4px; font-size: 11px; font-weight: bold; margin-left: 6px; vertical-align: middle; }
        .badge-premium { background: #ffebeb; color: #d63031; border: 1px solid #ffcccc; } /* ê³ ê¸‰ìœ  */
        .badge-regular { background: #e8f5e9; color: #2e7d32; border: 1px solid #c8e6c9; } /* ì¼ë°˜ìœ  */
        .badge-diesel { background: #dfe6e9; color: #2d3436; border: 1px solid #b2bec3; }  /* ê²½ìœ  */
        .badge-electric { background: #e3f2fd; color: #0277bd; border: 1px solid #b3e5fc; } /* ì „ê¸° (íŒŒë€ìƒ‰) */

        .risk-box { background: #fff5f5; border: 1px solid #ffcccc; color: #d63031; padding: 15px; border-radius: 8px; font-size: 14px; line-height: 1.6; word-break: keep-all; }
        .item-list { list-style: none; padding: 0; }
        .item-list li { background: #f9f9f9; padding: 12px; margin-bottom: 8px; border-radius: 8px; font-size: 14px; }
        .loading { text-align: center; display: none; padding: 20px; }
        
        .seo-content { margin-top: 50px; padding: 20px; background: #fff; border-radius: 16px; color: #444; }
        .seo-content h2 { font-size: 18px; margin-bottom: 10px; color: #1d1d1f; }
        .seo-content h3 { font-size: 16px; margin-top: 25px; margin-bottom: 8px; color: #333; }
        .seo-content p { font-size: 14px; line-height: 1.6; margin-bottom: 15px; color: #666; }

        footer { text-align: center; margin-top: 40px; color: #86868b; font-size: 12px; padding-bottom: 20px; }
    </style>
</head>
<body>

    <header>
        <h1>ğŸš— ìë™ì°¨ ìœ ì§€ë¹„ ê³„ì‚°ê¸°</h1>
        <p style="text-align: center; color: #666; font-size: 14px; margin-top: -20px; margin-bottom: 30px;">AIê°€ ë¶„ì„í•˜ëŠ” ì°¨ëŸ‰ ë³´í—˜ë£Œ, ì„¸ê¸ˆ, ìœ ë¥˜ë¹„, ì •ë¹„ë¹„ê¹Œì§€ í•œëˆˆì—!</p>
    </header>
    
    <main>
        <div class="card">
            <div class="input-group">
                <label for="carModel">ì°¨ëŸ‰ ëª¨ë¸ëª… <span style="color:red">*</span></label>
                <input type="text" id="carModel" placeholder="ì˜ˆ: BMW 520d, ì•„ë°˜ë–¼ CN7, í…ŒìŠ¬ë¼ ëª¨ë¸3">
            </div>
            <div class="input-group">
                <label for="carYear">ì°¨ëŸ‰ ì—°ì‹ <span style="color:red">*</span></label>
                <input type="number" id="carYear" placeholder="2023" value="2023">
            </div>
            <div style="display: flex; gap: 10px;">
                <div class="input-group" style="flex: 1;">
                    <label for="birthYear">ì¶œìƒë…„ë„ <span style="color:red">*</span></label>
                    <input type="number" id="birthYear" placeholder="1995" value="1995">
                </div>
                <div class="input-group" style="flex: 1;">
                    <label for="drivingExp">ìš´ì „ ê²½ë ¥ <span style="color:red">*</span></label>
                    <select id="drivingExp">
                        <option value="0">ì‹ ê·œ (0ë…„)</option>
                        <option value="1">1~2ë…„</option>
                        <option value="3">3ë…„ ì´ìƒ</option>
                    </select>
                </div>
            </div>
            <button onclick="calculate()">ğŸ’° AI ì •ë°€ ìœ ì§€ë¹„ ë¶„ì„ ì‹œì‘</button>
        </div>

        <div id="loading" class="loading">
            <p><strong>Car Agent</strong>ê°€ ê³ ê°ë‹˜ì˜ ì¡°ê±´ê³¼<br>ì‹¤ì‹œê°„ ìœ ê°€/ë³´í—˜ ë°ì´í„°ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...ğŸ•µï¸â€â™‚ï¸</p>
        </div>

        <div id="result" style="display:none;">
            <div class="card" style="border: 2px solid #0071e3; background: #f0f7ff;">
                <div style="text-align: center;">
                    <span style="font-size: 14px; color: #0071e3; font-weight: bold;">ì›” ì˜ˆìƒ ìœ ì§€ë¹„</span>
                    <div class="price-tag" id="monthlyTotal">0ì›</div>
                    <span style="font-size: 13px; color: #666;">(í• ë¶€ê¸ˆ ì œì™¸ ìˆœìˆ˜ ìœ ì§€ë¹„)</span>
                </div>
            </div>

            <div class="card">
                <h3>ğŸ“Š 1ë…„ ìƒì„¸ ì§€ì¶œ ëª…ì„¸ì„œ</h3>
                <div class="detail-row">
                    <span id="fuelLabel">â›½ ì—°ê°„ ì£¼ìœ ë¹„ (12,000km) <span id="fuelBadge"></span></span>
                    <span id="fuelCost" style="font-weight:bold;">0ì›</span>
                </div>
                <div class="detail-row">
                    <span>ğŸ› ìë™ì°¨ì„¸ (ì—°ë‚©í• ì¸ ë¯¸ì ìš©)</span>
                    <span id="taxCost" style="font-weight:bold;">0ì›</span>
                </div>
                <div class="detail-row">
                    <span>ğŸ›¡ ìë™ì°¨ ë³´í—˜ë£Œ(ì˜ˆìƒ)</span>
                    <span id="insCost" style="font-weight:bold; color: #0071e3;">0ì›</span>
                </div>
                <div class="detail-row">
                    <span>ğŸ”§ ì •ë¹„/ì†Œëª¨í’ˆ ì˜ˆë¹„ë¹„</span>
                    <span id="repairCost" style="font-weight:bold;">0ì›</span>
                </div>
            </div>

            <div class="card">
                <h3>ğŸ”© ì£¼ìš” ì†Œëª¨í’ˆ êµì²´ ë¹„ìš© (ì˜ˆìƒ)</h3>
                <ul id="maintenanceList" class="item-list"></ul>
            </div>

            <div class="card">
                <h3>âš ï¸ êµ¬ë§¤ ì „ í•„ë… (ê³ ì§ˆë³‘ ë¦¬í¬íŠ¸)</h3>
                <div id="riskBox" class="risk-box"></div>
                <p id="aiComment" style="margin-top:15px; font-size:14px; color:#555; font-style:italic; line-height: 1.5;"></p>
            </div>
        </div>

        <section class="seo-content">
            <h2>ğŸ’¡ ìë™ì°¨ ìœ ì§€ë¹„ ê³„ì‚°ê¸°, ì™œ í•„ìš”í• ê¹Œìš”?</h2>
            <p>
                ë§ì€ ë¶„ë“¤ì´ ì°¨ëŸ‰ êµ¬ë§¤ ì‹œ <strong>ì°¨ëŸ‰ ê°€ê²©</strong>ê³¼ í• ë¶€ê¸ˆë§Œ ìƒê°í•˜ì§€ë§Œ, ì‹¤ì œë¡œ ìš°ë¦¬ë¥¼ í˜ë“¤ê²Œ í•˜ëŠ” ê²ƒì€ ë§¤ë‹¬ ë‚˜ê°€ëŠ” <strong>ì°¨ ìœ ì§€ë¹„</strong>ì…ë‹ˆë‹¤.
                Car Agent ìë™ì°¨ ìœ ì§€ë¹„ ê³„ì‚°ê¸°ëŠ” <strong>ìë™ì°¨ì„¸, ë³´í—˜ë£Œ, ìœ ë¥˜ë¹„(ì¶©ì „ë¹„), ì •ë¹„ ì˜ˆë¹„ë¹„</strong>ë¥¼ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ í˜„ì‹¤ì ì¸ ì°¨ëŸ‰ ìœ ì§€ë¹„ë¥¼ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.
            </p>

            <h3>â“ ì‚¬íšŒì´ˆë…„ìƒ ì²«ì°¨, ì°¨ëŸ‰ ìœ ì§€ë¹„ ì–¼ë§ˆë‚˜ ë“¤ê¹Œ?</h3>
            <p>
                ì•„ë°˜ë–¼, K3 ê°™ì€ ì¤€ì¤‘í˜• ì„¸ë‹¨ë„ ë§Œ 26ì„¸ ë¯¸ë§Œì´ë¼ë©´ <strong>ìë™ì°¨ ë³´í—˜ë£Œ</strong>ê°€ ì—° 200ë§Œ ì›ì„ ë„˜ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                ë³¸ ì°¨ ìœ ì§€ë¹„ ê³„ì‚°ê¸°ë¥¼ í†µí•´ ë‚´ ë‚˜ì´ì™€ ìš´ì „ ê²½ë ¥ì— ë§ëŠ” ì •í™•í•œ ìë™ì°¨ ìœ ì§€ë¹„ë¥¼ ë¯¸ë¦¬ í™•ì¸í•´ë³´ì„¸ìš”.
            </p>

            <h3>âš™ï¸ ìˆ˜ì…ì°¨/ì „ê¸°ì°¨ ì°¨ëŸ‰ ìœ ì§€ë¹„ì˜ ì§„ì‹¤</h3>
            <p>
                ìˆ˜ì…ì°¨ëŠ” êµ­ì‚°ì°¨ ëŒ€ë¹„ <strong>ë¶€í’ˆê°’ê³¼ ê³µì„ë¹„ê°€ 2~3ë°°</strong> ë¹„ìŒ‰ë‹ˆë‹¤. ì „ê¸°ì°¨ëŠ” ì¶©ì „ë¹„ëŠ” ì €ë ´í•˜ì§€ë§Œ <strong>ë³´í—˜ë£Œì™€ íƒ€ì´ì–´ ê°’</strong>ì´ ë¹„ìŒ€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                ë‹¨ìˆœíˆ ì—°ë£Œë¹„ë§Œ ê³„ì‚°í•´ì„œëŠ” ì•ˆ ë˜ë©°, ì›ŒëŸ°í‹° ë§Œë£Œ í›„ ë°œìƒí•  ìˆ˜ ìˆëŠ” <strong>ê³ ì§ˆë³‘ ìˆ˜ë¦¬ë¹„</strong>ë¥¼ ì˜ˆë¹„ë¹„ë¡œ ì¡ì•„ë‘ëŠ” ê²ƒì´ í˜„ëª…í•©ë‹ˆë‹¤.
            </p>
        </section>
    </main>

    <footer>
        <p>&copy; 2026 Car Agent. All rights reserved.</p>
        <p>ë³¸ ê²°ê³¼ëŠ” AI ì¶”ì •ì¹˜ì´ë©° ì‹¤ì œ ë¹„ìš©ê³¼ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </footer>

    <script>
        async function calculate() {
            const btn = document.querySelector('button');
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');
            
            // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
            const carModel = document.getElementById('carModel').value.trim();
            const carYearVal = document.getElementById('carYear').value;
            const birthYearVal = document.getElementById('birthYear').value;
            const drivingExp = document.getElementById('drivingExp').value;
            
            // === [ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§] ===
            if (!carModel) {
                alert("ğŸš— ì°¨ëŸ‰ ëª¨ë¸ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                document.getElementById('carModel').focus();
                return;
            }

            const currentYear = new Date().getFullYear();
            const carYear = parseInt(carYearVal);
            const birthYear = parseInt(birthYearVal);
            const age = currentYear - birthYear;

            if (isNaN(carYear) || carYear < 1950 || carYear > currentYear + 1) {
                alert(`ğŸ“… ì°¨ëŸ‰ ì—°ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.\n(1950ë…„ ~ ${currentYear + 1}ë…„ ì‚¬ì´ë§Œ ê°€ëŠ¥)`);
                document.getElementById('carYear').focus();
                return;
            }

            if (isNaN(birthYear) || age < 18) {
                alert("ğŸ” ë§Œ 18ì„¸ ë¯¸ë§Œì€ ìš´ì „ë©´í—ˆë¥¼ ì·¨ë“í•  ìˆ˜ ì—†ì–´\nì •í™•í•œ ê³„ì‚°ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.");
                document.getElementById('birthYear').focus();
                return;
            }

            if (age > 100) {
                alert("ğŸ‘´ 100ì„¸ ì´ìƒìœ¼ë¡œ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤.\nì •í™•í•œ ì¶œìƒë…„ë„ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
                document.getElementById('birthYear').focus();
                return;
            }
            
            // === [ìœ íš¨ì„± ê²€ì‚¬ í†µê³¼] ===

            btn.disabled = true;
            loading.style.display = 'block';
            result.style.display = 'none';

            // [ì¤‘ìš”] Webhook URL - ë³¸ì¸ì˜ URLì´ ë§ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
            const webhookUrl = 'https://bot.hopto.org/webhook/car-cost-calc'; 

            try {
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ 
                        car_model: carModel, 
                        car_year: carYear,
                        birth_year: birthYear, 
                        driving_exp: drivingExp
                    })
                });

                // [ì¤‘ìš”] ë°ì´í„°ë¥¼ ë³€ìˆ˜(let)ë¡œ ì„ ì–¸í•´ì•¼ ë®ì–´ì“°ê¸° ê°€ëŠ¥
                let data = await response.json();
                
                // â˜…â˜…â˜… [ë°°ì—´ ê»ì§ˆ ë²—ê¸°ê¸° - í•µì‹¬ í•´ê²°ì±…] â˜…â˜…â˜…
                // n8n ì‘ë‹µì´ [{...}] í˜•íƒœë¼ë©´ ì²« ë²ˆì§¸ ìš”ì†Œë§Œ êº¼ëƒ…ë‹ˆë‹¤.
                if (Array.isArray(data) && data.length > 0) {
                    console.log("ë°°ì—´ ë°ì´í„° ê°ì§€ë¨. ì²« ë²ˆì§¸ í•­ëª© ì¶”ì¶œ:", data[0]);
                    data = data[0];
                } else {
                    console.log("ê°ì²´ ë°ì´í„° ê°ì§€ë¨:", data);
                }

                const fmt = (n) => parseInt(n).toLocaleString() + 'ì›';

                // ë°ì´í„° ë°”ì¸ë”©
                document.getElementById('monthlyTotal').innerText = fmt(data.calculated.total_monthly);
                document.getElementById('fuelCost').innerText = fmt(data.yearly_costs.fuel_20k);
                document.getElementById('taxCost').innerText = fmt(data.calculated.tax_year);
                document.getElementById('insCost').innerText = fmt(data.yearly_costs.insurance);
                document.getElementById('repairCost').innerText = fmt(data.yearly_costs.repair_fund);

                // =======================================================
                // [ë°°ì§€ ë° í…ìŠ¤íŠ¸ ì²˜ë¦¬ ë¡œì§]
                // =======================================================
                const badgeSpan = document.getElementById('fuelBadge');
                const fuelLabel = document.getElementById('fuelLabel');
                
                // 1. ë°±ì—”ë“œ í”Œë˜ê·¸ í™•ì¸ (ì•ˆì „í•˜ê²Œ chaining)
                let isEV = (data.calculated && data.calculated.is_electric === true);
                
                // 2. í…ìŠ¤íŠ¸ í™•ì¸ (ë³´ì¡° ìˆ˜ë‹¨)
                const fuelGrade = (data.specs.fuel_grade || "").toLowerCase();
                const fuelType = (data.specs.fuel_type || "").toLowerCase();
                
                if (fuelGrade.includes("ì „ê¸°") || fuelGrade.includes("electric") || fuelType.includes("ì „ê¸°")) {
                    isEV = true;
                }

                // 3. [ìµœí›„ì˜ ë³´ë£¨] ì—°ë£Œë¹„ê°€ 100ë§Œì› ì´í•˜ì¸ë° í•˜ì´ë¸Œë¦¬ë“œê°€ ì•„ë‹ˆë©´ ì „ê¸°ì°¨ë¡œ ê°„ì£¼
                if (!isEV && data.yearly_costs.fuel_20k < 1000000 && !fuelGrade.includes("hybrid") && !fuelGrade.includes("í•˜ì´ë¸Œë¦¬ë“œ")) {
                    console.log("ì—°ë£Œë¹„ê°€ ì €ë ´í•˜ì—¬ ì „ê¸°ì°¨ë¡œ ìë™ ë³´ì •í–ˆìŠµë‹ˆë‹¤.");
                    isEV = true;
                }

                // [ë Œë”ë§]
                if (isEV) {
                    // ì „ê¸°ì°¨
                    badgeSpan.innerHTML = `<span class="badge badge-electric">âš¡ì „ê¸°</span>`;
                    fuelLabel.innerHTML = `âš¡ ì—°ê°„ ì¶©ì „ë¹„ (12,000km) <span id="fuelBadge"><span class="badge badge-electric">âš¡ì „ê¸°</span></span>`;
                } else if(fuelGrade.includes("ê³ ê¸‰") || fuelGrade.includes("premium")) {
                    // ê³ ê¸‰ìœ 
                    badgeSpan.innerHTML = `<span class="badge badge-premium">ğŸ”¥ê³ ê¸‰ìœ </span>`;
                    fuelLabel.innerHTML = `â›½ ì—°ê°„ ì£¼ìœ ë¹„ (12,000km) <span id="fuelBadge"><span class="badge badge-premium">ğŸ”¥ê³ ê¸‰ìœ </span></span>`;
                } else if(fuelGrade.includes("ê²½ìœ ") || fuelGrade.includes("ë””ì ¤") || fuelGrade.includes("diesel")) {
                    // ë””ì ¤
                    badgeSpan.innerHTML = `<span class="badge badge-diesel">â›½ê²½ìœ </span>`;
                    fuelLabel.innerHTML = `â›½ ì—°ê°„ ì£¼ìœ ë¹„ (12,000km) <span id="fuelBadge"><span class="badge badge-diesel">â›½ê²½ìœ </span></span>`;
                } else {
                    // ì¼ë°˜ìœ 
                    badgeSpan.innerHTML = `<span class="badge badge-regular">ğŸ’§ì¼ë°˜ìœ </span>`;
                    fuelLabel.innerHTML = `â›½ ì—°ê°„ ì£¼ìœ ë¹„ (12,000km) <span id="fuelBadge"><span class="badge badge-regular">ğŸ’§ì¼ë°˜ìœ </span></span>`;
                }

                // ìœ ì§€ë³´ìˆ˜ í•­ëª© ë¦¬ìŠ¤íŠ¸
                const list = document.getElementById('maintenanceList');
                list.innerHTML = '';
                if(data.maintenance_items) {
                    data.maintenance_items.forEach(item => {
                        list.innerHTML += `<li>
                            <div style="display:flex; justify-content:space-between;">
                                <strong>${item.part}</strong>
                                <span>${fmt(item.cost)}</span>
                            </div>
                            <div style="font-size:12px; color:#888; margin-top:2px;">ğŸ”„ ${item.cycle}</div>
                        </li>`;
                    });
                }

                document.getElementById('riskBox').innerText = data.risk_report;
                document.getElementById('aiComment').innerText = `ğŸ’¡ "${data.total_comment}"`;

                result.style.display = 'block';

            } catch (error) {
                alert('ê³„ì‚° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                console.error(error);
            } finally {
                btn.disabled = false;
                loading.style.display = 'none';
            }
        }
    </script>
</body>
</html>
